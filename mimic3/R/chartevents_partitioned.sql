-- Autogenerated with create_partitionning_chartevents.R
-- CREATE CHARTEVENTS TABLE
CREATE TABLE chartevents_1 ( CHECK ( itemid >= 1  AND itemid < 161 )) INHERITS (chartevents);
CREATE TABLE chartevents_2 ( CHECK ( itemid >= 161  AND itemid < 428 )) INHERITS (chartevents);
CREATE TABLE chartevents_3 ( CHECK ( itemid >= 428  AND itemid < 615 )) INHERITS (chartevents);
CREATE TABLE chartevents_4 ( CHECK ( itemid >= 615  AND itemid < 742 )) INHERITS (chartevents);
CREATE TABLE chartevents_5 ( CHECK ( itemid >= 742  AND itemid < 3338 )) INHERITS (chartevents);
CREATE TABLE chartevents_6 ( CHECK ( itemid >= 3338  AND itemid < 3723 )) INHERITS (chartevents);
CREATE TABLE chartevents_7 ( CHECK ( itemid >= 3723  AND itemid < 8523 )) INHERITS (chartevents);
CREATE TABLE chartevents_8 ( CHECK ( itemid >= 8523  AND itemid < 220074 )) INHERITS (chartevents);
CREATE TABLE chartevents_9 ( CHECK ( itemid >= 220074  AND itemid < 223769 )) INHERITS (chartevents);
CREATE TABLE chartevents_10 ( CHECK ( itemid >= 223769  AND itemid < 228445 )) INHERITS (chartevents);
	
-- CREATE CHARTEVENTS TRIGGER
CREATE OR REPLACE FUNCTION chartevents_insert_trigger()
RETURNS TRIGGER AS $$
BEGIN


IF ( NEW.itemid >= 1 AND NEW.itemid < 161 ) THEN INSERT INTO chartevents_1 VALUES (NEW.*);
ELSIF ( NEW.itemid >= 161 AND NEW.itemid < 428 ) THEN INSERT INTO chartevents_2 VALUES (NEW.*);
ELSIF ( NEW.itemid >= 428 AND NEW.itemid < 615 ) THEN INSERT INTO chartevents_3 VALUES (NEW.*);
ELSIF ( NEW.itemid >= 615 AND NEW.itemid < 742 ) THEN INSERT INTO chartevents_4 VALUES (NEW.*);
ELSIF ( NEW.itemid >= 742 AND NEW.itemid < 3338 ) THEN INSERT INTO chartevents_5 VALUES (NEW.*);
ELSIF ( NEW.itemid >= 3338 AND NEW.itemid < 3723 ) THEN INSERT INTO chartevents_6 VALUES (NEW.*);
ELSIF ( NEW.itemid >= 3723 AND NEW.itemid < 8523 ) THEN INSERT INTO chartevents_7 VALUES (NEW.*);
ELSIF ( NEW.itemid >= 8523 AND NEW.itemid < 220074 ) THEN INSERT INTO chartevents_8 VALUES (NEW.*);
ELSIF ( NEW.itemid >= 220074 AND NEW.itemid < 223769 ) THEN INSERT INTO chartevents_9 VALUES (NEW.*);
ELSIF ( NEW.itemid >= 223769 AND NEW.itemid < 228445 ) THEN INSERT INTO chartevents_10 VALUES (NEW.*);
	ELSE
RAISE EXCEPTION 'Itemid out of range.  Fix the chartevents_insert_trigger() function!';
       END IF;
RETURN NULL;
END;
$$
LANGUAGE plpgsql;

CREATE TRIGGER insert_chartevents_trigger
    BEFORE INSERT ON chartevents
    FOR EACH ROW EXECUTE PROCEDURE chartevents_insert_trigger();

---------------
-- CHARTEVENTS 1
---------------
drop index MIMICIII.CHARTEVENTS_1_idx01;
CREATE INDEX CHARTEVENTS_1_idx01 
  ON MIMICIII.CHARTEVENTS_1 (SUBJECT_ID, HADM_ID, ICUSTAY_ID) WITH (FILLFACTOR=100);


drop index MIMICIII.CHARTEVENTS_1_idx02;
CREATE INDEX CHARTEVENTS_1_idx02 
  ON MIMICIII.CHARTEVENTS_1 (ITEMID) WITH (FILLFACTOR=100);


drop index MIMICIII.CHARTEVENTS_1_idx03;
CREATE INDEX CHARTEVENTS_1_idx03 
  ON MIMICIII.CHARTEVENTS_1 (CHARTTIME, STORETIME) WITH (FILLFACTOR=100);


drop index MIMICIII.CHARTEVENTS_1_idx04;
CREATE INDEX CHARTEVENTS_1_idx04 
  ON MIMICIII.CHARTEVENTS_1 (CGID) WITH (FILLFACTOR=100);


---------------
-- CHARTEVENTS 2
---------------
drop index MIMICIII.CHARTEVENTS_2_idx01;
CREATE INDEX CHARTEVENTS_2_idx01 
  ON MIMICIII.CHARTEVENTS_2 (SUBJECT_ID, HADM_ID, ICUSTAY_ID) WITH (FILLFACTOR=100);


drop index MIMICIII.CHARTEVENTS_2_idx02;
CREATE INDEX CHARTEVENTS_2_idx02 
  ON MIMICIII.CHARTEVENTS_2 (ITEMID) WITH (FILLFACTOR=100);


drop index MIMICIII.CHARTEVENTS_2_idx03;
CREATE INDEX CHARTEVENTS_2_idx03 
  ON MIMICIII.CHARTEVENTS_2 (CHARTTIME, STORETIME) WITH (FILLFACTOR=100);


drop index MIMICIII.CHARTEVENTS_2_idx04;
CREATE INDEX CHARTEVENTS_2_idx04 
  ON MIMICIII.CHARTEVENTS_2 (CGID) WITH (FILLFACTOR=100);


---------------
-- CHARTEVENTS 3
---------------
drop index MIMICIII.CHARTEVENTS_3_idx01;
CREATE INDEX CHARTEVENTS_3_idx01 
  ON MIMICIII.CHARTEVENTS_3 (SUBJECT_ID, HADM_ID, ICUSTAY_ID) WITH (FILLFACTOR=100);


drop index MIMICIII.CHARTEVENTS_3_idx02;
CREATE INDEX CHARTEVENTS_3_idx02 
  ON MIMICIII.CHARTEVENTS_3 (ITEMID) WITH (FILLFACTOR=100);


drop index MIMICIII.CHARTEVENTS_3_idx03;
CREATE INDEX CHARTEVENTS_3_idx03 
  ON MIMICIII.CHARTEVENTS_3 (CHARTTIME, STORETIME) WITH (FILLFACTOR=100);


drop index MIMICIII.CHARTEVENTS_3_idx04;
CREATE INDEX CHARTEVENTS_3_idx04 
  ON MIMICIII.CHARTEVENTS_3 (CGID) WITH (FILLFACTOR=100);


---------------
-- CHARTEVENTS 4
---------------
drop index MIMICIII.CHARTEVENTS_4_idx01;
CREATE INDEX CHARTEVENTS_4_idx01 
  ON MIMICIII.CHARTEVENTS_4 (SUBJECT_ID, HADM_ID, ICUSTAY_ID) WITH (FILLFACTOR=100);


drop index MIMICIII.CHARTEVENTS_4_idx02;
CREATE INDEX CHARTEVENTS_4_idx02 
  ON MIMICIII.CHARTEVENTS_4 (ITEMID) WITH (FILLFACTOR=100);


drop index MIMICIII.CHARTEVENTS_4_idx03;
CREATE INDEX CHARTEVENTS_4_idx03 
  ON MIMICIII.CHARTEVENTS_4 (CHARTTIME, STORETIME) WITH (FILLFACTOR=100);


drop index MIMICIII.CHARTEVENTS_4_idx04;
CREATE INDEX CHARTEVENTS_4_idx04 
  ON MIMICIII.CHARTEVENTS_4 (CGID) WITH (FILLFACTOR=100);


---------------
-- CHARTEVENTS 5
---------------
drop index MIMICIII.CHARTEVENTS_5_idx01;
CREATE INDEX CHARTEVENTS_5_idx01 
  ON MIMICIII.CHARTEVENTS_5 (SUBJECT_ID, HADM_ID, ICUSTAY_ID) WITH (FILLFACTOR=100);


drop index MIMICIII.CHARTEVENTS_5_idx02;
CREATE INDEX CHARTEVENTS_5_idx02 
  ON MIMICIII.CHARTEVENTS_5 (ITEMID) WITH (FILLFACTOR=100);


drop index MIMICIII.CHARTEVENTS_5_idx03;
CREATE INDEX CHARTEVENTS_5_idx03 
  ON MIMICIII.CHARTEVENTS_5 (CHARTTIME, STORETIME) WITH (FILLFACTOR=100);


drop index MIMICIII.CHARTEVENTS_5_idx04;
CREATE INDEX CHARTEVENTS_5_idx04 
  ON MIMICIII.CHARTEVENTS_5 (CGID) WITH (FILLFACTOR=100);


---------------
-- CHARTEVENTS 6
---------------
drop index MIMICIII.CHARTEVENTS_6_idx01;
CREATE INDEX CHARTEVENTS_6_idx01 
  ON MIMICIII.CHARTEVENTS_6 (SUBJECT_ID, HADM_ID, ICUSTAY_ID) WITH (FILLFACTOR=100);


drop index MIMICIII.CHARTEVENTS_6_idx02;
CREATE INDEX CHARTEVENTS_6_idx02 
  ON MIMICIII.CHARTEVENTS_6 (ITEMID) WITH (FILLFACTOR=100);


drop index MIMICIII.CHARTEVENTS_6_idx03;
CREATE INDEX CHARTEVENTS_6_idx03 
  ON MIMICIII.CHARTEVENTS_6 (CHARTTIME, STORETIME) WITH (FILLFACTOR=100);


drop index MIMICIII.CHARTEVENTS_6_idx04;
CREATE INDEX CHARTEVENTS_6_idx04 
  ON MIMICIII.CHARTEVENTS_6 (CGID) WITH (FILLFACTOR=100);


---------------
-- CHARTEVENTS 7
---------------
drop index MIMICIII.CHARTEVENTS_7_idx01;
CREATE INDEX CHARTEVENTS_7_idx01 
  ON MIMICIII.CHARTEVENTS_7 (SUBJECT_ID, HADM_ID, ICUSTAY_ID) WITH (FILLFACTOR=100);


drop index MIMICIII.CHARTEVENTS_7_idx02;
CREATE INDEX CHARTEVENTS_7_idx02 
  ON MIMICIII.CHARTEVENTS_7 (ITEMID) WITH (FILLFACTOR=100);


drop index MIMICIII.CHARTEVENTS_7_idx03;
CREATE INDEX CHARTEVENTS_7_idx03 
  ON MIMICIII.CHARTEVENTS_7 (CHARTTIME, STORETIME) WITH (FILLFACTOR=100);


drop index MIMICIII.CHARTEVENTS_7_idx04;
CREATE INDEX CHARTEVENTS_7_idx04 
  ON MIMICIII.CHARTEVENTS_7 (CGID) WITH (FILLFACTOR=100);


---------------
-- CHARTEVENTS 8
---------------
drop index MIMICIII.CHARTEVENTS_8_idx01;
CREATE INDEX CHARTEVENTS_8_idx01 
  ON MIMICIII.CHARTEVENTS_8 (SUBJECT_ID, HADM_ID, ICUSTAY_ID) WITH (FILLFACTOR=100);


drop index MIMICIII.CHARTEVENTS_8_idx02;
CREATE INDEX CHARTEVENTS_8_idx02 
  ON MIMICIII.CHARTEVENTS_8 (ITEMID) WITH (FILLFACTOR=100);


drop index MIMICIII.CHARTEVENTS_8_idx03;
CREATE INDEX CHARTEVENTS_8_idx03 
  ON MIMICIII.CHARTEVENTS_8 (CHARTTIME, STORETIME) WITH (FILLFACTOR=100);


drop index MIMICIII.CHARTEVENTS_8_idx04;
CREATE INDEX CHARTEVENTS_8_idx04 
  ON MIMICIII.CHARTEVENTS_8 (CGID) WITH (FILLFACTOR=100);


---------------
-- CHARTEVENTS 9
---------------
drop index MIMICIII.CHARTEVENTS_9_idx01;
CREATE INDEX CHARTEVENTS_9_idx01 
  ON MIMICIII.CHARTEVENTS_9 (SUBJECT_ID, HADM_ID, ICUSTAY_ID) WITH (FILLFACTOR=100);


drop index MIMICIII.CHARTEVENTS_9_idx02;
CREATE INDEX CHARTEVENTS_9_idx02 
  ON MIMICIII.CHARTEVENTS_9 (ITEMID) WITH (FILLFACTOR=100);


drop index MIMICIII.CHARTEVENTS_9_idx03;
CREATE INDEX CHARTEVENTS_9_idx03 
  ON MIMICIII.CHARTEVENTS_9 (CHARTTIME, STORETIME) WITH (FILLFACTOR=100);


drop index MIMICIII.CHARTEVENTS_9_idx04;
CREATE INDEX CHARTEVENTS_9_idx04 
  ON MIMICIII.CHARTEVENTS_9 (CGID) WITH (FILLFACTOR=100);


---------------
-- CHARTEVENTS 10
---------------
drop index MIMICIII.CHARTEVENTS_10_idx01;
CREATE INDEX CHARTEVENTS_10_idx01 
  ON MIMICIII.CHARTEVENTS_10 (SUBJECT_ID, HADM_ID, ICUSTAY_ID) WITH (FILLFACTOR=100);


drop index MIMICIII.CHARTEVENTS_10_idx02;
CREATE INDEX CHARTEVENTS_10_idx02 
  ON MIMICIII.CHARTEVENTS_10 (ITEMID) WITH (FILLFACTOR=100);


drop index MIMICIII.CHARTEVENTS_10_idx03;
CREATE INDEX CHARTEVENTS_10_idx03 
  ON MIMICIII.CHARTEVENTS_10 (CHARTTIME, STORETIME) WITH (FILLFACTOR=100);


drop index MIMICIII.CHARTEVENTS_10_idx04;
CREATE INDEX CHARTEVENTS_10_idx04 
  ON MIMICIII.CHARTEVENTS_10 (CGID) WITH (FILLFACTOR=100);
